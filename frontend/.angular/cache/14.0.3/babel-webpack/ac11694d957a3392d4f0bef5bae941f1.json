{"ast":null,"code":"import _createForOfIteratorHelper from \"C:/Users/SAMUEL/Desktop/UdacityProjects/theCoffee_shopApp/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"C:/Users/SAMUEL/Desktop/UdacityProjects/theCoffee_shopApp/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/SAMUEL/Desktop/UdacityProjects/theCoffee_shopApp/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { AuthService } from './auth.service';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./auth.service\";\nimport * as i2 from \"@angular/common/http\";\nexport var DrinksService = /*#__PURE__*/(function () {\n  var DrinksService = /*#__PURE__*/function () {\n    // = {\n    //                             1: {\n    //                             id: 1,\n    //                             title: 'matcha shake',\n    //                             recipe: [\n    //                                   {\n    //                                     name: 'milk',\n    //                                     color: 'grey',\n    //                                     parts: 1\n    //                                   },\n    //                                   {\n    //                                     name: 'matcha',\n    //                                     color: 'green',\n    //                                     parts: 3\n    //                                   },\n    //                                 ]\n    //                           },\n    //                           2: {\n    //                             id: 2,\n    //                             title: 'flatwhite',\n    //                             recipe: [\n    //                                   {\n    //                                     name: 'milk',\n    //                                     color: 'grey',\n    //                                     parts: 3\n    //                                   },\n    //                                   {\n    //                                     name: 'coffee',\n    //                                     color: 'brown',\n    //                                     parts: 1\n    //                                   },\n    //                                 ]\n    //                           },\n    //                           3: {\n    //                             id: 3,\n    //                             title: 'cap',\n    //                             recipe: [\n    //                                   {\n    //                                     name: 'foam',\n    //                                     color: 'white',\n    //                                     parts: 1\n    //                                   },\n    //                                   {\n    //                                     name: 'milk',\n    //                                     color: 'grey',\n    //                                     parts: 2\n    //                                   },\n    //                                   {\n    //                                     name: 'coffee',\n    //                                     color: 'brown',\n    //                                     parts: 1\n    //                                   },\n    //                                 ]\n    //                           }\n    //   };\n    function DrinksService(auth, http) {\n      _classCallCheck(this, DrinksService);\n\n      this.auth = auth;\n      this.http = http;\n      this.url = environment.apiServerUrl;\n      this.items = {};\n    }\n\n    _createClass(DrinksService, [{\n      key: \"getHeaders\",\n      value: function getHeaders() {\n        var header = {\n          headers: new HttpHeaders().set('Authorization', \"Bearer \".concat(this.auth.activeJWT()))\n        };\n        return header;\n      }\n    }, {\n      key: \"getDrinks\",\n      value: function getDrinks() {\n        var _this = this;\n\n        if (this.auth.can('get:drinks-detail')) {\n          this.http.get(this.url + '/drinks-detail', this.getHeaders()).subscribe(function (res) {\n            _this.drinksToItems(res.drinks);\n\n            console.log(res);\n          });\n        } else {\n          this.http.get(this.url + '/drinks', this.getHeaders()).subscribe(function (res) {\n            _this.drinksToItems(res.drinks);\n\n            console.log(res);\n          });\n        }\n      }\n    }, {\n      key: \"saveDrink\",\n      value: function saveDrink(drink) {\n        var _this2 = this;\n\n        if (drink.id >= 0) {\n          // patch\n          this.http.patch(this.url + '/drinks/' + drink.id, drink, this.getHeaders()).subscribe(function (res) {\n            if (res.success) {\n              _this2.drinksToItems(res.drinks);\n            }\n          });\n        } else {\n          // insert\n          this.http.post(this.url + '/drinks', drink, this.getHeaders()).subscribe(function (res) {\n            if (res.success) {\n              _this2.drinksToItems(res.drinks);\n            }\n          });\n        }\n      }\n    }, {\n      key: \"deleteDrink\",\n      value: function deleteDrink(drink) {\n        delete this.items[drink.id];\n        this.http.delete(this.url + '/drinks/' + drink.id, this.getHeaders()).subscribe(function (res) {});\n      }\n    }, {\n      key: \"drinksToItems\",\n      value: function drinksToItems(drinks) {\n        var _iterator = _createForOfIteratorHelper(drinks),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var drink = _step.value;\n            this.items[drink.id] = drink;\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n    }]);\n\n    return DrinksService;\n  }();\n\n  DrinksService.ɵfac = function DrinksService_Factory(t) {\n    return new (t || DrinksService)(i0.ɵɵinject(i1.AuthService), i0.ɵɵinject(i2.HttpClient));\n  };\n\n  DrinksService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: DrinksService,\n    factory: DrinksService.ɵfac,\n    providedIn: 'root'\n  });\n  return DrinksService;\n})();","map":null,"metadata":{},"sourceType":"module"}